

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Is the Ideology Gap Growing? &#8212; Probably Overthinking It</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ideology_gap';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Bertrand’s Boxes" href="bertrand.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    <p class="title logo__title">Probably Overthinking It</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Probably Overthinking It
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="gaussian.html">Are You Normal? Hint: No.</a></li>
<li class="toctree-l1"><a class="reference internal" href="inspection.html">Relay Races and Revolving Doors</a></li>
<li class="toctree-l1"><a class="reference internal" href="preston.html">Defy Tradition, Save the World</a></li>
<li class="toctree-l1"><a class="reference internal" href="lognormal.html">Extremes, Outliers, and GOATs</a></li>
<li class="toctree-l1"><a class="reference internal" href="nbue.html">Better Than New</a></li>
<li class="toctree-l1"><a class="reference internal" href="berkson.html">Jumping to Conclusions</a></li>
<li class="toctree-l1"><a class="reference internal" href="birthweight.html">Causation, Collision, and Confusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="longtail.html">The Long Tail of Disaster</a></li>
<li class="toctree-l1"><a class="reference internal" href="base_rate.html">Fairness and Fallacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="simpson.html">Penguins, Pessimists, and Paradoxes</a></li>
<li class="toctree-l1"><a class="reference internal" href="progress.html">Changing Hearts and Minds</a></li>
<li class="toctree-l1"><a class="reference internal" href="overton.html">Chasing the Overton Window</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ansur_pca.html">The Principal Components of Anthropometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="bertrand.html">Bertrand’s Boxes</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Is the Ideology Gap Growing?</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/AllenDowney/ProbablyOverthinkingIt" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/ideology_gap.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Is the Ideology Gap Growing?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-the-data">Read the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-the-plot-with-all-respondents">Make the plot with all respondents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#just-young-people">Just young people</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#with-sampling-weights">With Sampling Weights</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-and-smoothing">Resampling and smoothing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-and-smoothing-without-2022">Resampling and smoothing without 2022</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adjusting">Adjusting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whats-wrong-with-2022">What’s wrong with 2022?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="is-the-ideology-gap-growing">
<h1>Is the Ideology Gap Growing?<a class="headerlink" href="#is-the-ideology-gap-growing" title="Permalink to this heading">#</a></h1>
<p><a class="reference external" href="https://twitter.com/jburnmurdoch/status/1750849189834022932">This tweet</a> from John Burn-Murdoch links to an article in the Financial Times, <a class="reference external" href="https://www.ft.com/content/29fd9b5c-2f35-41bf-9d4c-994db4e12998">“A new global gender divide is emerging”</a>, which includes this figure:</p>
<p><img alt="" src="https://github.com/AllenDowney/ProbablyOverthinkingIt/blob/book/data/ft_ideology_gap.png?raw=true" /></p>
<p>The article claims:</p>
<blockquote>
<div><p>In the US, Gallup data shows that after decades where the sexes were each spread roughly equally across liberal and conservative world views, women aged 18 to 30 are now 30 percentage points more liberal than their male contemporaries. That gap took just six years to open up.</p>
</div></blockquote>
<p>The figure says it is based on General Social Survey data and the text says it’s based on Gallup data, so I’m not sure which it is. UPDATE: In <a class="reference external" href="https://twitter.com/jburnmurdoch/status/1751656332380262418">this tweet</a> Burn-Murdoch explains that the figure shows Gallup data, backfilled with GSS data from before the Gallup series began.</p>
<p>And I don’t know what it means that “All figures are adjusted for time trend in the overall population”. UPDATE: See the section below that explains the adjustment.</p>
<p>Anyway, since I used GSS data in the last three chapters of <a class="reference external" href="https://greenteapress.com/wp/probably-overthinking-it/"><em>Probably Overthinking It</em></a>, this analysis did not sound right to me.</p>
<p>This notebook is my attempt to replicate the analysis with GSS data. I conclude:</p>
<ul class="simple">
<li><p>The GSS data does not look like the figure in the FT.</p></li>
<li><p>Men are a more likely to say that they are conservative, by 5-10 percentage points.</p></li>
<li><p>The only evidence that the gap is growing depends entirely on a data point from 2022 that is almost certainly wrong.</p></li>
<li><p>If we drop the 2022 data and apply moderate smoothing, we see no evidence that the gap is growing.</p></li>
</ul>
<p>Most of the functions in this notebook are the ones I used to write <em>Probably Overthinking It</em>. All of <a class="reference external" href="https://allendowney.github.io/ProbablyOverthinkingIt/intro.html">the notebooks for that book are available in this repository</a>.</p>
<p><a class="reference external" href="https://colab.research.google.com/github/AllenDowney/ProbablyOverthinkingIt/blob/book/examples/ideology_gap.ipynb">Click here to run this notebook on Colab</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.nonparametric.smoothers_lowess</span> <span class="kn">import</span> <span class="n">lowess</span>


<span class="k">def</span> <span class="nf">make_lowess</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Use LOWESS to compute a smooth line.</span>

<span class="sd">    series: pd.Series</span>

<span class="sd">    returns: pd.Series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

    <span class="n">smooth</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="p">)</span>
    <span class="n">index</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">smooth</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_series_lowess</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">plot_series</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots a series of data points and a smooth line.</span>

<span class="sd">    series: pd.Series</span>
<span class="sd">    color: string or tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;label&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">options</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">name</span>

    <span class="k">if</span> <span class="n">plot_series</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">index</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">plot_series</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">index</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">])</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">smooth</span> <span class="o">=</span> <span class="n">make_lowess</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="p">)</span>
        <span class="n">smooth</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">decorate</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorate the current axes.</span>

<span class="sd">    Call decorate with keyword arguments like</span>
<span class="sd">    decorate(title=&#39;Title&#39;,</span>
<span class="sd">             xlabel=&#39;x&#39;,</span>
<span class="sd">             ylabel=&#39;y&#39;)</span>

<span class="sd">    The keyword arguments can be any of the axis properties</span>
<span class="sd">    https://matplotlib.org/api/axes_api.html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>

    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">handles</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="read-the-data">
<h2>Read the Data<a class="headerlink" href="#read-the-data" title="Permalink to this heading">#</a></h2>
<p>I’m using data I previous cleaned in <a class="reference external" href="https://github.com/AllenDowney/GssExtract/blob/main/notebooks/01_make_pacs_extract.ipynb">this notebook</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exists</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>


<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span>

        <span class="n">local</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloaded &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">local</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">filename</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/GssExtract/raw/main/data/interim/gss_pacs_2022.hdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;gss_pacs_2022.hdf&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s2">&quot;gss_pacs_2022.hdf&quot;</span><span class="p">,</span> <span class="s2">&quot;gss&quot;</span><span class="p">)</span>
<span class="n">gss</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(72390, 205)
</pre></div>
</div>
</div>
</div>
<p>The primary variable we’ll use is <a class="reference external" href="https://subsetdataexplorer.norc.org/variables/178/vshow">polviews</a>, which asks</p>
<blockquote>
<div><p>We hear a lot of talk these days about liberals and conservatives. I’m going to show you a seven-point scale on which the political views that people might hold are arranged from extremely liberal–point 1–to extremely conservative–point 7. Where would you place yourself on this scale?</p>
</div></blockquote>
<p>The points on the scale are Extremely liberal, Liberal, and Slightly liberal; Moderate;	Slightly conservative, Conservative, and Extremely conservative.</p>
<p>I’ll clean <code class="docutils literal notranslate"><span class="pre">polviews</span></code>, replacing cases where the question was not asked or the respondent did not answer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gss</span><span class="p">[</span><span class="s1">&#39;polviews&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To confirm that my cleaning did not introduce errors, I compared the following cross-tabulation with the one in the <a class="reference external" href="https://subsetdataexplorer.norc.org/variables/178/vshow">GSS Explorer</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year</span> <span class="o">=</span> <span class="n">gss</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span>
<span class="n">column</span> <span class="o">=</span> <span class="n">gss</span><span class="p">[</span><span class="s2">&quot;polviews&quot;</span><span class="p">]</span>
<span class="n">xtab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
<span class="n">xtab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>1974</th>
      <th>1975</th>
      <th>1976</th>
      <th>1977</th>
      <th>1978</th>
      <th>1980</th>
      <th>1982</th>
      <th>1983</th>
      <th>1984</th>
      <th>1985</th>
      <th>...</th>
      <th>2004</th>
      <th>2006</th>
      <th>2008</th>
      <th>2010</th>
      <th>2012</th>
      <th>2014</th>
      <th>2016</th>
      <th>2018</th>
      <th>2021</th>
      <th>2022</th>
    </tr>
    <tr>
      <th>polviews</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.0</th>
      <td>22</td>
      <td>46</td>
      <td>31</td>
      <td>37</td>
      <td>22</td>
      <td>36</td>
      <td>48</td>
      <td>16</td>
      <td>29</td>
      <td>35</td>
      <td>...</td>
      <td>46</td>
      <td>139</td>
      <td>69</td>
      <td>76</td>
      <td>81</td>
      <td>94</td>
      <td>136</td>
      <td>122</td>
      <td>207</td>
      <td>192</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>201</td>
      <td>179</td>
      <td>187</td>
      <td>169</td>
      <td>142</td>
      <td>121</td>
      <td>199</td>
      <td>67</td>
      <td>133</td>
      <td>163</td>
      <td>...</td>
      <td>120</td>
      <td>524</td>
      <td>240</td>
      <td>259</td>
      <td>244</td>
      <td>304</td>
      <td>350</td>
      <td>278</td>
      <td>623</td>
      <td>486</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>207</td>
      <td>196</td>
      <td>186</td>
      <td>214</td>
      <td>241</td>
      <td>208</td>
      <td>267</td>
      <td>98</td>
      <td>177</td>
      <td>171</td>
      <td>...</td>
      <td>153</td>
      <td>517</td>
      <td>221</td>
      <td>232</td>
      <td>208</td>
      <td>263</td>
      <td>310</td>
      <td>256</td>
      <td>490</td>
      <td>400</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>564</td>
      <td>559</td>
      <td>559</td>
      <td>564</td>
      <td>549</td>
      <td>582</td>
      <td>694</td>
      <td>319</td>
      <td>568</td>
      <td>566</td>
      <td>...</td>
      <td>497</td>
      <td>1683</td>
      <td>740</td>
      <td>746</td>
      <td>713</td>
      <td>989</td>
      <td>1032</td>
      <td>855</td>
      <td>1377</td>
      <td>1245</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>221</td>
      <td>232</td>
      <td>221</td>
      <td>251</td>
      <td>263</td>
      <td>258</td>
      <td>235</td>
      <td>142</td>
      <td>276</td>
      <td>271</td>
      <td>...</td>
      <td>214</td>
      <td>618</td>
      <td>268</td>
      <td>265</td>
      <td>268</td>
      <td>334</td>
      <td>382</td>
      <td>283</td>
      <td>476</td>
      <td>430</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>160</td>
      <td>150</td>
      <td>190</td>
      <td>179</td>
      <td>188</td>
      <td>180</td>
      <td>229</td>
      <td>108</td>
      <td>186</td>
      <td>214</td>
      <td>...</td>
      <td>223</td>
      <td>685</td>
      <td>327</td>
      <td>315</td>
      <td>292</td>
      <td>358</td>
      <td>426</td>
      <td>354</td>
      <td>617</td>
      <td>514</td>
    </tr>
    <tr>
      <th>7.0</th>
      <td>35</td>
      <td>35</td>
      <td>27</td>
      <td>39</td>
      <td>30</td>
      <td>44</td>
      <td>67</td>
      <td>20</td>
      <td>41</td>
      <td>42</td>
      <td>...</td>
      <td>56</td>
      <td>167</td>
      <td>68</td>
      <td>80</td>
      <td>68</td>
      <td>107</td>
      <td>120</td>
      <td>99</td>
      <td>174</td>
      <td>159</td>
    </tr>
  </tbody>
</table>
<p>7 rows × 32 columns</p>
</div></div></div>
</div>
<p>I’ll lump the first three points into “Liberal” and the last three into “Conservative”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">recode_polviews</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Liberal&quot;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;Liberal&quot;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;Liberal&quot;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;Moderate&quot;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;Conservative&quot;</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;Conservative&quot;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;Conservative&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gss</span><span class="p">[</span><span class="s2">&quot;polviews3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gss</span><span class="p">[</span><span class="s2">&quot;polviews&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">recode_polviews</span><span class="p">)</span>
<span class="n">gss</span><span class="p">[</span><span class="s2">&quot;polviews3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>polviews3
Moderate        23992
Conservative    21122
Liberal         17604
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_diff</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute % liberal minus % conservative.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;polviews3&quot;</span><span class="p">]</span>

    <span class="n">xtab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">xtab</span><span class="p">[</span><span class="s1">&#39;Liberal&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">xtab</span><span class="p">[</span><span class="s1">&#39;Conservative&#39;</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">diff</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_mean</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute % liberal minus % conservative.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">series</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="s1">&#39;polviews&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">series</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">decorate_plot</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">% li</span><span class="s1">beral - </span><span class="si">% c</span><span class="s1">onservative&#39;</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-the-plot-with-all-respondents">
<h2>Make the plot with all respondents<a class="headerlink" href="#make-the-plot-with-all-respondents" title="Permalink to this heading">#</a></h2>
<p>The following functions generate a figure like the one in the FT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot % liberal - % conservative for male and female respondents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">male</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;sex==1&#39;</span><span class="p">)</span>
    <span class="n">female</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;sex==2&#39;</span><span class="p">)</span>

    <span class="n">diff_male</span> <span class="o">=</span> <span class="n">make_diff</span><span class="p">(</span><span class="n">male</span><span class="p">)</span>
    <span class="n">diff_female</span> <span class="o">=</span> <span class="n">make_diff</span><span class="p">(</span><span class="n">female</span><span class="p">)</span>

    <span class="n">plot_series_lowess</span><span class="p">(</span><span class="n">diff_male</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Male&#39;</span><span class="p">)</span>
    <span class="n">plot_series_lowess</span><span class="p">(</span><span class="n">diff_female</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Female&#39;</span><span class="p">)</span>
    <span class="n">decorate_plot</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Generate the plot for all respondents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;dpi&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make_plot</span><span class="p">(</span><span class="n">gss</span><span class="p">,</span> <span class="s1">&#39;All respondents&#39;</span><span class="p">)</span>
<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ideology_gap1.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/226f0cae1c29bfc7f3335ab221fc18066c45636c5b3fd08f14881f46c136d3d5.png" src="_images/226f0cae1c29bfc7f3335ab221fc18066c45636c5b3fd08f14881f46c136d3d5.png" />
</div>
</div>
<p>In the general population, men are more likely to say they are conservative by 5-10 percentage points.</p>
<p>The gap might have increased in the most recent data, depending on how seriously we take the last two points in a noisy series.</p>
</section>
<section id="just-young-people">
<h2>Just young people<a class="headerlink" href="#just-young-people" title="Permalink to this heading">#</a></h2>
<p>Now let’s select just people under 30.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">gss</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;age &lt; 30&#39;</span><span class="p">)</span>
<span class="n">subset</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(14360, 206)
</pre></div>
</div>
</div>
</div>
<p>And make the same figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make_plot</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="s1">&#39;Age &lt; 30&#39;</span><span class="p">)</span>
<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ideology_gap2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5d72f4588d6871fdab57f3f1b61ab17cc392f3091d9d822d08a1fc32c6b33b6a.png" src="_images/5d72f4588d6871fdab57f3f1b61ab17cc392f3091d9d822d08a1fc32c6b33b6a.png" />
</div>
</div>
<p>The trends here are pretty much the same as in the general population.
Men are more likely to say they are conservative, by 5-10 percentage points.</p>
<p>It’s possible that the gap has grown in the most recent data, but the evidence is weak and depends on how we draw a smooth curve through noisy data.</p>
<p>Anyway, there is no evidence the trend for men is going down, and the gap in the most recent data is nowhere near 30 percentage points.</p>
<p>Here are the sample sizes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span>
<span class="n">column</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span>
<span class="n">xtab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
<span class="n">xtab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>1972</th>
      <th>1973</th>
      <th>1974</th>
      <th>1975</th>
      <th>1976</th>
      <th>1977</th>
      <th>1978</th>
      <th>1980</th>
      <th>1982</th>
      <th>1983</th>
      <th>...</th>
      <th>2004</th>
      <th>2006</th>
      <th>2008</th>
      <th>2010</th>
      <th>2012</th>
      <th>2014</th>
      <th>2016</th>
      <th>2018</th>
      <th>2021</th>
      <th>2022</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.0</th>
      <td>223</td>
      <td>180</td>
      <td>176</td>
      <td>181</td>
      <td>187</td>
      <td>175</td>
      <td>167</td>
      <td>142</td>
      <td>222</td>
      <td>182</td>
      <td>...</td>
      <td>253</td>
      <td>351</td>
      <td>157</td>
      <td>153</td>
      <td>155</td>
      <td>190</td>
      <td>228</td>
      <td>185</td>
      <td>177</td>
      <td>246</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>177</td>
      <td>203</td>
      <td>204</td>
      <td>224</td>
      <td>201</td>
      <td>193</td>
      <td>240</td>
      <td>215</td>
      <td>274</td>
      <td>233</td>
      <td>...</td>
      <td>288</td>
      <td>415</td>
      <td>202</td>
      <td>222</td>
      <td>176</td>
      <td>198</td>
      <td>253</td>
      <td>213</td>
      <td>226</td>
      <td>307</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 34 columns</p>
</div></div></div>
</div>
</section>
<section id="with-sampling-weights">
<h2>With Sampling Weights<a class="headerlink" href="#with-sampling-weights" title="Permalink to this heading">#</a></h2>
<p>In the previous figures, I have not taken into account the sampling weights.
I didn’t expect them to make much difference, and they don’t except for men in 2022 – and as we’ll see, there is almost certainly something wrong with that data point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">male</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;sex==1&#39;</span><span class="p">)</span>
<span class="n">female</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;sex==2&#39;</span><span class="p">)</span>

<span class="n">diff_male</span> <span class="o">=</span> <span class="n">make_diff</span><span class="p">(</span><span class="n">male</span><span class="p">)</span>
<span class="n">diff_female</span> <span class="o">=</span> <span class="n">make_diff</span><span class="p">(</span><span class="n">female</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We only have weighted data since 1988, since that’s how far back the <code class="docutils literal notranslate"><span class="pre">wtssps</span></code> variable goes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">recent</span> <span class="o">=</span> <span class="n">gss</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;wtssps&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;age &lt; 30&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">resample_rows_weighted</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resamples a DataFrame using probabilities proportional to given column.</span>

<span class="sd">    df: DataFrame</span>
<span class="sd">    column: string column name to use as weights</span>

<span class="sd">    returns: DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sample</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">resample_by_year</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resample rows within each year.</span>

<span class="sd">    df: DataFrame</span>
<span class="sd">    column: string name of weight variable</span>

<span class="sd">    returns DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">resample_rows_weighted</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">]</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sample</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">percentile_rows</span><span class="p">(</span><span class="n">series_seq</span><span class="p">,</span> <span class="n">ps</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes percentiles from aligned series.</span>

<span class="sd">    series_seq: list of sequences</span>
<span class="sd">    ps: cumulative probabilities</span>

<span class="sd">    returns: Series of x-values, NumPy array with selected rows</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">series_seq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">nrows</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="n">ps</span> <span class="o">*</span> <span class="n">nrows</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">xs</span><span class="p">,</span> <span class="n">rows</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_percentiles</span><span class="p">(</span><span class="n">series_seq</span><span class="p">,</span> <span class="n">ps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the low, median, and high percentiles.</span>

<span class="sd">    series_seq: sequence of Series</span>
<span class="sd">    ps: percentiles to use for low, medium and high</span>
<span class="sd">    label: string label for the median line</span>
<span class="sd">    options: options passed plt.plot and plt.fill_between</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>

    <span class="n">xs</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">percentile_rows</span><span class="p">(</span><span class="n">series_seq</span><span class="p">,</span> <span class="n">ps</span><span class="p">)</span>
    <span class="n">low</span><span class="p">,</span> <span class="n">med</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="n">rows</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">med</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">resample_diffs</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">iters</span><span class="o">=</span><span class="mi">101</span><span class="p">):</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iters</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">resample_by_year</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;wtssps&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">make_diff</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        <span class="n">diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diffs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diffs_male</span> <span class="o">=</span> <span class="n">resample_diffs</span><span class="p">(</span><span class="n">recent</span><span class="p">,</span> <span class="s1">&#39;sex==1&#39;</span><span class="p">)</span>
<span class="n">diffs_female</span> <span class="o">=</span> <span class="n">resample_diffs</span><span class="p">(</span><span class="n">recent</span><span class="p">,</span> <span class="s1">&#39;sex==2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This figure shows the median of 101 resamplings and a 90% CI, along with the unweighted data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_percentiles</span><span class="p">(</span><span class="n">diffs_male</span><span class="p">)</span>
<span class="n">plot_percentiles</span><span class="p">(</span><span class="n">diffs_female</span><span class="p">)</span>

<span class="n">diff_male</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Male&#39;</span><span class="p">)</span>
<span class="n">diff_female</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Female&#39;</span><span class="p">)</span>

<span class="n">decorate_plot</span><span class="p">(</span><span class="s1">&#39;Age &lt; 30 with sampling weights&#39;</span><span class="p">)</span>
<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ideology_gap3.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e5fac031cc7e5557751490690c894c7e9a903f4257b3eb7446fd8cf9d9194820.png" src="_images/e5fac031cc7e5557751490690c894c7e9a903f4257b3eb7446fd8cf9d9194820.png" />
</div>
</div>
<p>In most cases, the unweighted data falls in the CI of the weighted data, but for male respondents in 2022, the weighting moves the needle by almost 30 percentage points.</p>
<p>So something is not right there. I think the best option is to drop the 2022 data, but just for completeness, let’s see what happens if we apply some smoothing.</p>
</section>
<section id="resampling-and-smoothing">
<h2>Resampling and smoothing<a class="headerlink" href="#resampling-and-smoothing" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">resample_diffs_smooth</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">iters</span><span class="o">=</span><span class="mi">101</span><span class="p">):</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iters</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">resample_by_year</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;wtssps&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">make_diff</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        <span class="n">smooth</span> <span class="o">=</span> <span class="n">make_lowess</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
        <span class="n">diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">smooth</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diffs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diffs_male</span> <span class="o">=</span> <span class="n">resample_diffs_smooth</span><span class="p">(</span><span class="n">recent</span><span class="p">,</span> <span class="s1">&#39;sex==1&#39;</span><span class="p">)</span>
<span class="n">diffs_female</span> <span class="o">=</span> <span class="n">resample_diffs_smooth</span><span class="p">(</span><span class="n">recent</span><span class="p">,</span> <span class="s1">&#39;sex==2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s a version of the same plot with moderate smoothing, and dropping the unweighted data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_percentiles</span><span class="p">(</span><span class="n">diffs_male</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Male&#39;</span><span class="p">)</span>
<span class="n">plot_percentiles</span><span class="p">(</span><span class="n">diffs_female</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Female&#39;</span><span class="p">)</span>

<span class="n">decorate_plot</span><span class="p">(</span><span class="s1">&#39;Age &lt; 30 with sampling weights, smoothed&#39;</span><span class="p">)</span>
<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ideology_gap4.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/baf2755acfbd444ac55a4e3282c65a30bcff0ee307d45ee56aea317e3492e253.png" src="_images/baf2755acfbd444ac55a4e3282c65a30bcff0ee307d45ee56aea317e3492e253.png" />
</div>
</div>
<p>You could make the argument that this figure shows evidence for an increasing gap, but the error bounds are very wide, and as we’ll see in the next figure, the entire effect is due to the likely error in the 2022 data.</p>
</section>
<section id="resampling-and-smoothing-without-2022">
<h2>Resampling and smoothing without 2022<a class="headerlink" href="#resampling-and-smoothing-without-2022" title="Permalink to this heading">#</a></h2>
<p>Finally, here’s the analysis I think is the best choice, dropping the 2022 data for both men and women.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre2022</span> <span class="o">=</span> <span class="n">recent</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year &lt; 2022&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diffs_male</span> <span class="o">=</span> <span class="n">resample_diffs_smooth</span><span class="p">(</span><span class="n">pre2022</span><span class="p">,</span> <span class="s1">&#39;sex==1&#39;</span><span class="p">)</span>
<span class="n">diffs_female</span> <span class="o">=</span> <span class="n">resample_diffs_smooth</span><span class="p">(</span><span class="n">pre2022</span><span class="p">,</span> <span class="s1">&#39;sex==2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_percentiles</span><span class="p">(</span><span class="n">diffs_male</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Male&#39;</span><span class="p">)</span>
<span class="n">plot_percentiles</span><span class="p">(</span><span class="n">diffs_female</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Female&#39;</span><span class="p">)</span>

<span class="n">decorate_plot</span><span class="p">(</span><span class="s1">&#39;Age &lt; 30 with sampling weights, smoothed, no 2022&#39;</span><span class="p">)</span>
<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ideology_gap5.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/21e3230f146cefcc1f430020661d16e914b0f713b2b09f39aaaea54c30afcb7d.png" src="_images/21e3230f146cefcc1f430020661d16e914b0f713b2b09f39aaaea54c30afcb7d.png" />
</div>
</div>
<p>Since the 1990s, both men and women have become more likely to identify as liberal.</p>
<p>Men are more likely to identify as conservative by 5-10 percentage points.</p>
<p>But this figure shows no evidence that the ideology gap is growing.</p>
</section>
<section id="adjusting">
<h2>Adjusting<a class="headerlink" href="#adjusting" title="Permalink to this heading">#</a></h2>
<p>In <a class="reference external" href="https://twitter.com/jburnmurdoch/status/1751569229516550403">this tweet</a>, Burn-Murdoch explains that the adjustment mentioned in the figure is to subtract off the overall trend.</p>
<p>Here’s the overall trend, not including the 2022 data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff_overall</span> <span class="o">=</span> <span class="n">make_diff</span><span class="p">(</span><span class="n">pre2022</span><span class="p">)</span>

<span class="n">plot_series_lowess</span><span class="p">(</span><span class="n">diff_overall</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Overall&#39;</span><span class="p">)</span>
<span class="n">decorate_plot</span><span class="p">(</span><span class="s1">&#39;Overall&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/271676c236f954004d04fd6cd7d1c62c2e344514eefee04b37b9de4a91815d2f.png" src="_images/271676c236f954004d04fd6cd7d1c62c2e344514eefee04b37b9de4a91815d2f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">resample_diffs_smooth_adjusted</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">iters</span><span class="o">=</span><span class="mi">101</span><span class="p">):</span>
    <span class="n">diff_overall</span> <span class="o">=</span> <span class="n">make_diff</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">diff_overall_smooth</span> <span class="o">=</span> <span class="n">make_lowess</span><span class="p">(</span><span class="n">diff_overall</span><span class="p">)</span>

    <span class="n">diffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iters</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">resample_by_year</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;wtssps&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">make_diff</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        <span class="n">smooth</span> <span class="o">=</span> <span class="n">make_lowess</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">-</span> <span class="n">diff_overall_smooth</span>
        <span class="n">diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">smooth</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diffs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diffs_male</span> <span class="o">=</span> <span class="n">resample_diffs_smooth_adjusted</span><span class="p">(</span><span class="n">pre2022</span><span class="p">,</span> <span class="s1">&#39;sex==1&#39;</span><span class="p">)</span>
<span class="n">diffs_female</span> <span class="o">=</span> <span class="n">resample_diffs_smooth_adjusted</span><span class="p">(</span><span class="n">pre2022</span><span class="p">,</span> <span class="s1">&#39;sex==2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s what the adjusted data looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_percentiles</span><span class="p">(</span><span class="n">diffs_male</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Male&#39;</span><span class="p">)</span>
<span class="n">plot_percentiles</span><span class="p">(</span><span class="n">diffs_female</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Female&#39;</span><span class="p">)</span>

<span class="n">decorate_plot</span><span class="p">(</span><span class="s1">&#39;Age &lt; 30 with sampling weights, smoothed, no 2022, adjusted&#39;</span><span class="p">)</span>
<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ideology_gap6.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/322455b233fb27300e45dd1fb881fe2566066e524269925649c636db76160193.png" src="_images/322455b233fb27300e45dd1fb881fe2566066e524269925649c636db76160193.png" />
</div>
</div>
<p>This figure gives a stronger visual sense that the gap is growing, but even then, it is probably not more than 10 percentage points, and smaller than it was in the 1980s.</p>
<p>This way of showing the data makes it seem as if men are increasingly likely to say they are conservative, which is misleading.
They are increasingly likely to say they are liberal, but not increasing as fast as the overall average.</p>
</section>
<section id="whats-wrong-with-2022">
<h2>What’s wrong with 2022?<a class="headerlink" href="#whats-wrong-with-2022" title="Permalink to this heading">#</a></h2>
<p>I don’t know yet, but I’ll add some explorations here.</p>
<p>For one thing, the magnitudes of the weights are substantially different than in previous years, which is why they are able to drag the results so far.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year&gt;2010 and sex==2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="s1">&#39;wtssall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>176.0</td>
      <td>1.172650</td>
      <td>0.662591</td>
      <td>0.411898</td>
      <td>0.823796</td>
      <td>0.823796</td>
      <td>1.647593</td>
      <td>3.495950</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>198.0</td>
      <td>1.162238</td>
      <td>0.612888</td>
      <td>0.448002</td>
      <td>0.896003</td>
      <td>0.896003</td>
      <td>1.380591</td>
      <td>3.451477</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>253.0</td>
      <td>1.121762</td>
      <td>0.558590</td>
      <td>0.478497</td>
      <td>0.782182</td>
      <td>0.956994</td>
      <td>1.435490</td>
      <td>3.910908</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>213.0</td>
      <td>1.197720</td>
      <td>0.725489</td>
      <td>0.471499</td>
      <td>0.942997</td>
      <td>0.942997</td>
      <td>1.414496</td>
      <td>5.897420</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>226.0</td>
      <td>1.638973</td>
      <td>1.090648</td>
      <td>0.361567</td>
      <td>0.835459</td>
      <td>1.411978</td>
      <td>2.014895</td>
      <td>6.159929</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>307.0</td>
      <td>1.230579</td>
      <td>1.438955</td>
      <td>0.143659</td>
      <td>0.420716</td>
      <td>0.743450</td>
      <td>1.295847</td>
      <td>9.343494</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="bertrand.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Bertrand’s Boxes</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-the-data">Read the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-the-plot-with-all-respondents">Make the plot with all respondents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#just-young-people">Just young people</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#with-sampling-weights">With Sampling Weights</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-and-smoothing">Resampling and smoothing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-and-smoothing-without-2022">Resampling and smoothing without 2022</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adjusting">Adjusting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whats-wrong-with-2022">What’s wrong with 2022?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Allen B. Downey
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>